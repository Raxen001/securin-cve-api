<!DOCTYPE html>
<html lang="en">
  <head>
    <title>cve list</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="css/style.css" rel="stylesheet">
  </head>
<style>
  tr th {
    border: 1px solid black;
    color: red;
  }
  tr, td{
    border: 1px solid black;
    gap: 1rem;
    padding: 1rem;
  }
</style>
  <body>
    <h1>Total: {{total}}</h1>
    <h2>Results: {{search_total}}</h2>
    <form action="/" method="GET">

        <label for="year">year:</label>
      <input type="text" id="year" name="year" value="{{inputs.year}}">

        <label for="lastmodified">lastmodified:</label>
        <input type="number" id="lastmodified" name="lastmodified" value="{{inputs.lastmodified}}">

        <label for="lt">lesser than score:</label>
        <input type="number" step="any" id="lt" name="lt" value="{{inputs.lt}}">

        <label for="gt">greater than score:</label>
        <input type="number" step="any" id="gt" name="gt" value="{{inputs.gt}}">

        <label for="limit">limit:</label>
        <select name="limit" id="limit">
        <option value=10 {%if inputs.limit == 10 %} selected="selected" {% endif %}>10</option>
          <option value=50 {%if inputs.limit == 50 %} selected="selected" {% endif %}>50</option>
          <option value=100 {%if inputs.limit == 100 %} selected="selected" {% endif %}>100</option>
        </select>

        <br>
        <br>
        <input type="submit" value="Submit">
        <br>
        <br>
    </form>
     {% if has_prev %}
          <a href="{{ url_for('index', page=page-1) }}">Previous</a>
     {% endif %}
      
     {% if has_next %}
          <a href="{{ url_for('index', page=page+1) }}">Next</a>
     {% endif %}
    <table>
      <tr>
      <th>CVE ID</th>
      <th>IDENTIFIER</th>
      <th>PUBLISHED DATE</th>
      <th>LAST MODIFIED</th>
      <th>STATUS</th>
      <th>BASE SCORE</th>
    </tr>
      {% for data in datas %}
        <tr>
          <td><a href="/cve/lists/id/{{ data.id }}">{{ data.id }}</td>
          <td>{{ data.sourceIdentifier }}</td>
          <td>{{ data.published }}</td>
          <td>{{ data.lastModified }}</td>
          <td>{{ data.vulnStatus }}</td>
          {% if "cvssMetricV2" in data.metrics.keys()  %}
            <td>{{data.metrics.cvssMetricV2[0].cvssData.baseScore}}</td>
          {% endif %}
          {% if "cvssMetricV3" in data.metrics.keys()  %}
            <td>{{data.metrics.cvssMetricV3[0].cvssData.baseScore}}</td>
          {% endif %}
        </tr>
      {% endfor %}
    </table>
  </body>
</html>
