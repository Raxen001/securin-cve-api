<!DOCTYPE html>
<html lang="en">
  <head>
    <title>cve list</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="css/style.css" rel="stylesheet">
  </head>
  <style>
  table {
    border: 1px solid black;
    margin: 0;
    padding: 0;
    border-spacing: 0;
  }
  tr, th, td{
    border: 1px solid black;
    padding: 2ch;
  }
  strong{
    color: red;
  }
  div {
    display: flex;
    align-items: center;
    gap: 3ch;
  }
  </style>
  <body>
      <h1>{{ data.id }}</h1>

      <h2>DESCRIPTION:</h2>

    <p>{{ data.descriptions[0].value }}</p>


    {% if "cvssMetricV2" in data.metrics.keys()  %}

      <h2>CVSS V2 METRICS</h2>
      <div>
        <div>
          <h3>Severity</h3>
        <p>{{ data.metrics.cvssMetricV2[0].baseSeverity }}</p>
        </div>
        <div>
          <h3>Score</h3>
        <p><strong>{{ data.metrics.cvssMetricV2[0].cvssData.baseScore }}</strong></p>
        </div>
      </div>
      <div>
      <h2>VECTOR STRING</h2>
      <p>{{ data.metrics.cvssMetricV2[0].cvssData.vectorString }}</p>
      </div>

      <table>
        <tr>
          <th>Access Vector</th>
          <th>Access Complexity</th>
          <th>Authentication</th>
          <th>confidentiality impact</th>
          <th>Integrity Impact</th>
          <th>availability Impact</th>
        </tr>
        <tr>
        <td>{{data.metrics.cvssMetricV2[0].cvssData.accessVector}}</td>
        <td>{{data.metrics.cvssMetricV2[0].cvssData.accessComplexity}}</td>
        <td>{{data.metrics.cvssMetricV2[0].cvssData.authentication}}</td>
        <td>{{data.metrics.cvssMetricV2[0].cvssData.confidentialityImpact}}</td>
        <td>{{data.metrics.cvssMetricV2[0].cvssData.integrityImpact}}</td>
        <td>{{data.metrics.cvssMetricV2[0].cvssData.availabilityImpact}}</td>
        </tr>


      </table>

      <h2>SCORES: </h2>
      <div>
        <h3>Exploitablity Score: </h3>
        <h4>{{data.metrics.cvssMetricV2[0].exploitabilityScore}}</h4>
      </div>
      <div>
      <h3>Impact Score: </h3>
      <h4>{{data.metrics.cvssMetricV2[0].impactScore}}</h4>
      </div>
      
    {% endif %}

    {% if "cvssMetric31" in data.metrics.keys()  %}
      <h2>CVSS V3 METRICS</h2>
      <div>
        <div>
          <h3>Severity</h3>{{ data.metrics.cvssMetric31[0].baseSeverity }}
        </div>
        <div>
          <h3>Score</h3><strong>{{ data.metrics.cvssMetric31[0].cvssData.baseScore }}</strong>
        </div>
      </div>
      <div>
      <h2>VECTOR STRING</h2>
      <p>{{ data.metrics.cvssMetricV31[0].cvssData.vectorString }}</p>
      </div>

      <table>
        <tr>
          <th>Access Vector</th>
          <th>Access Complexity</th>
          <th>Authentication</th>
          <th>confidentiality impact</th>
          <th>Integrity Impact</th>
          <th>availability Impact</th>
        </tr>
        <tr>
        <td>{{data.metrics.cvssMetricV31[0].cvssData.accessVector}}</td>
        <td>{{data.metrics.cvssMetricV31[0].cvssData.accessComplexity}}</td>
        <td>{{data.metrics.cvssMetricV31[0].cvssData.authentication}}</td>
        <td>{{data.metrics.cvssMetricV31[0].cvssData.confidentialityImpact}}</td>
        <td>{{data.metrics.cvssMetricV31[0].cvssData.integrityImpact}}</td>
        <td>{{data.metrics.cvssMetricV31[0].cvssData.availabilityImpact}}</td>
        </tr>
      </table>


      <h2>SCORES: </h2>
      <h3>Exploitablity Score</h3>
      <p>{{data.metrics.cvssMetricV3[0].exploitabilityScore}}</p>

      <h3>Impact Score: </h3>
      <p>{{data.metrics.cvssMetricV3[0].impactScore}}</p>
    
    {% endif %}


    <h2>CPE</h2>
    <table>
      <tr>
        <th>Criteria</th>
        <th>Match Criteria ID</th>
        <th>Vulnerable</th>
      </tr>

      {% if "configurations" in data.keys()  %}
      {% for cpe in data.configurations[0].nodes[0].cpeMatch %}
      <tr>
        <td>{{ cpe.criteria }}</td>
        <td>{{ cpe.matchCriteriaId }}</td>
        <td>{{ cpe.vulnerable }}</td>
      </tr>
      {% endfor %}
      {%endif%}
    </table>

  </body>
</html>
