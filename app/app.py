from flask import Flask
from flask import render_template
#import requests
#import json

import pymongo
from pymongo import MongoClient
client = MongoClient('localhost', 27017)
database = client['cve']
collection = database['cve']

app = Flask(__name__)

@app.route('/')
@app.route('/cve/lists/')
def index():
    datas = collection.find().limit(10)
    return render_template("table.html", datas=datas)

@app.route('/cve/lists/id/<cve_id>')
def cve_id(cve_id):
    data = collection.find_one(cve_id)
    return render_template('single.html', datas=data)

@app.route('/cve/lists/year/<year>')
def cve_year(year):
    payload = {
            "published": 
                {
                    "$regex": year
                }
            }
    datas = collection.find(payload)
    return render_template("table.html", datas=datas)


if __name__ == "__main__":
    #get_sample_data()
    app.run(debug=True)
